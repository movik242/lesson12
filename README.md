# lesson12

**Домашнее задание**

1. Запустить nginx на нестандартном порту 3-мя разными способами:
  - переключатели setsebool;
  - добавление нестандартного порта в имеющийся тип;
  - формирование и установка модуля SELinux.

К сдаче:
 -- README с описанием каждого решения (скриншоты и демонстрация приветствуются).
 
2. Обеспечить работоспособность приложения при включенном selinux.
  - развернуть приложенный стенд https://github.com/mbfx/otus-linux-adm/tree/master/selinux_dns_problems;
  - выяснить причину неработоспособности механизма обновления зоны (см. README);
  - предложить решение (или решения) для данной проблемы;
  - выбрать одно из решений для реализации, предварительно обосновав выбор;
  - реализовать выбранное решение и продемонстрировать его работоспособность.

К сдаче:
 -- README с анализом причины неработоспособности, возможными способами решения и обоснованием выбора одного из них;
исправленный стенд или демонстрация работоспособной системы скриншотами и описанием.

**Основные команды и расположения файлов**

Для того чтобы работать с политиками сразу установим semanage: yum -y install policycoreutils-python

Просмотреть контекст безопасности на файлах, директориях и процессах можем командами ps -Z и ls -Z.

Узнать режим работы можно командой sestatus и getenforce

Файлы политик размещаются по пути - /etc/selinux/targeted/contexts/files

Лог аудита храниться в файле /var/log/audit/audit.log

Просмотреть текущие правила - sesearch -A -s httpd_t

Восстановить контекст (а также необходимо если надо окончательно применить новые метки файлов в файловой системе, чтобы заработало после перезагрузки) - restorecon /html

Проверка по портам - semanage port -l | grep ssh. Назначить доп. порты в тип правил (ssh) - semanage port -a -t ssh_port_t -p -tcp 5022. Удалить прописанный порт - semanage port -d -p tcp 5022. Порты по-умолчанию описанные в политике удалить нельзя.







